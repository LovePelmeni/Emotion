# Similarity Search for picking similar posts

Author: Klimushin Kirill Alexandrovich.
Date: 02/04/24

This document introduces FAISS-based approach model, 
used for searching for similar products in the service.

# Introduction
The goal was to create similarity search algorithm, based on 
FAISS library, designed by Facebook to find similar data vectors
from large dataset of generated samples.

# Prerequisities
We assume that project had over 40000 (512-dimensional) embedding vectors generated, which
required to be aggreated in the way we can find suggestions. Available resource mainly
consists of 2x 8-core CPUs. Total amount of RAM: 32Gb. 

Final Search index is composed of 2 parts:
    1. IVF Index for metadata search.
    2. Inverted File Product Quantization (IVFPQ) Index for embedding search.

Metadata is crucial component in this pipeline. It helps to apply pre / post filtering 
to initial set of embeddings and evaluate accuracy of the Embedding Similarity Search Index.

# IVF Metadata Search Index
Performs metadata search across dataset of vectors to filter out relevant samples.
We use JSON format to encode initial metadata representation into string.
Then we use Transformer-based network to encode this string into fixed size embedding,
which has the same length as multimodal embedding, generated by Fusion Layer, 
[see document]("docs/FUSION.md").

# IVFPQ Embedding Search Index
Initial 768 embedding representation is fairly large to perform similarity
search on disk with adequate, tenably low speed. Quantization dramatically reduces embedding
size by transforming vector into a lower level representation. Our approach combines Inverted File (IVF)
and Production Quantization (PQ) to reduce RAM footprint and move away all search calculations directly on disk, where data is stored. 

# Solution
We propose similarity search index. 
<search-img-idx>

# Training and evaluation

# Potential drawbacks and further improvements
List disadvantages and bottlenecks for inferencing on such a small
piece of data.
